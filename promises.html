<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body><script>
    let posts = [
  {
    title: "one post",
    body: "this is post one",
    createdate: new Date().getTime(),
  },
  {
    title: "second post",
    body: "this is post second",
    createdate: new Date().getTime(),
  },
];

let intervalId = 0;
function getpost() {
  clearInterval(intervalId);
  intervalId = setInterval(() => {
    setTimeout(() => {
      let output = '';
      for(var i=0;i<posts.length;i++){
        output += `<li>${posts[i].title}</li>`;
      }
      document.body.innerHTML = output;
    }, 2000);
  }, 1000);
}
getpost();

// creating a new promise::

function createPost(post) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      posts.push({ ...post, createdate: new Date().getTime() });
      const error = false;
      if (!error) {
        resolve();
      } else {
        reject("error:something went wrong");
      }
    }, 2000);
  });
}
// const user={
//     username: 'PK',lastActivitytime:'3 dec'
// }

// function updateLastActivityTime(){
//     return new Promise((resolve, reject) => {
//         setTimeout(()=>{
//             user.lastActivitytime=new Date().getTime();
//             resolve(user.lastActivitytime)
//         },1000)
//     })
// }


//  deletePost;

function deletePost(){
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            if(posts.length>0){
                const lastElement=posts.pop();
                resolve(lastElement);
            }else{
                reject('array is empty now')
            }
        },1000);
    })
}

///create post:

createPost({title:'post three',body:'this is post three'})
.then(()=>{
    getpost();
    
    deletePost().then((deletedElement)=>{
        getpost();
        deletePost().then(()=>{
            getpost();
            deletePost().then(()=>{})
            .catch((err)=>{
                console.log('inside catch block',err)
            })
        }).catch(()=>{})
    }).catch(()=>{})
})
.catch(err=>console.log(err));




</script>
    
</body>
</html>